  <!-- Core JS Files  -->
<script src="/assets/js/core/jquery-3.7.1.min.js"></script>
<script src="/assets/js/core/bootstrap.bundle.min.js"></script> 


<!-- jQuery Scrollbar -->
<script src="/assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>

<script src="/assets/js/plugin/jquery-ui/jquery-ui.min.js"></script>

<!-- Chart JS -->
<script src="/assets/js/plugin/chart.js/chart.min.js"></script>

<!-- jQuery Sparkline -->
<script src="/assets/js/plugin/jquery.sparkline/jquery.sparkline.min.js"></script>

<!-- Chart Circle -->
<script src="/assets/js/plugin/chart-circle/circles.min.js"></script>

<!-- Datatables -->
<script src="/assets/js/plugin/datatables/datatables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js"></script>
<!-- JS DataTables Responsive -->
<script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>

<!-- Bootstrap Notify -->
<script src="/assets/js/plugin/bootstrap-notify/bootstrap-notify.min.js"></script>

<!-- jQuery Vector Maps -->
<script src="/assets/js/plugin/jsvectormap/jsvectormap.min.js"></script>
<script src="/assets/js/plugin/jsvectormap/world.js"></script>

<!-- Sweet Alert -->
<script src="/assets/js/plugin/sweetalert/sweetalert.min.js"></script>

<!-- Kaiadmin JS -->
<script src="/assets/js/kaiadmin.min.js"></script>

<!-- Kaiadmin DEMO methods, don't include it in your project! -->
<script src="/assets/js/setting-demo.js"></script>
<script src="/assets/js/demo.js"></script>

<!-- PEMILIHAN PAGE JAVASCRIPT -->
<!-- <script src="<%= jslink %>"></script> -->
<!-- <% if (typeof jslink !== 'undefined') { %>
    <script src="<%= jslink %>"></script>
<% } else { %>
    <script src="javascripts/javascript.js"></script>
<% } %> -->
<script src="<%= jslink %>"></script>
<% if (typeof jslink2 !== 'undefined') { %>
  <script src="<%= jslink2 %>"></script>
<% } %>

<script src="/socket.io/socket.io.js"></script>



<script>
document.addEventListener("DOMContentLoaded", function () {
  const socket = io();

  socket.emit("init_user");

  socket.on("joined_admin_room", () => {
    console.log("‚úÖ Admin joined room");

    socket.on("user_registered", (data) => {
      console.log("üì¢ Notifikasi user baru:", data);

      $.notify({
        message: `${data.fullname} (${data.username}) baru saja mendaftar!`
      }, {
        type: 'info',
        delay: 100000,
        placement: {
          from: 'top',
          align: 'right'
        }
      });

      const notifBadge = document.querySelector(".notification");
      if (notifBadge) {
        let count = parseInt(notifBadge.textContent || "0");
        notifBadge.textContent = count + 1;
        notifBadge.style.display = "inline-block";
      } else {
        console.warn("‚ö†Ô∏è .notification tidak ditemukan");
      }

      const notifTitle = document.getElementById("notif-title");
      if (notifTitle) {
        let current = parseInt(document.querySelector(".notification").textContent || "0");
        notifTitle.textContent = `You have ${current + 1} new notification`;
      } else {
        console.warn("‚ö†Ô∏è #notif-title tidak ditemukan");
      }

      const notifCenter = document.getElementById("notif-center");
      if (notifCenter) {
        const notifItem = document.createElement("a");
        notifItem.href = "#";
        notifItem.innerHTML = `
          <div class="notif-icon notif-primary border-radius" style="width: 60px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background-color: #007bff; color: white;">
            <i class="fa fa-user-plus"></i>
          </div>
          <div class="notif-content">
            <span class="block" style="width: 205px;">
              ${data.message}
            </span>
            <span class="time">
              ${new Date().toLocaleString('id-ID', { hour: '2-digit', minute: '2-digit' })}
            </span>
          </div>
        `;
        notifCenter.prepend(notifItem);
      } else {
        console.warn("‚ö†Ô∏è #notif-center tidak ditemukan");
      }
    });
  });
});

</script>
<script>
//USERLEVEL START
document.addEventListener('DOMContentLoaded', () => {
  // Restore collapse states from localStorage
  document.querySelectorAll('.collapse').forEach((collapseParent) => {
    const id = collapseParent.getAttribute('data-menu-id');
    const isOpen = localStorage.getItem(`menu-collapse-${id}`);

    if(isOpen === 'true'){
      collapseParent.classList.add('show');

      const toggleLink = document.querySelector(`[data-bs-target="#${id}"]`);
      if(toggleLink) toggleLink.classList.remove('collapsed');
    }
  });

    document.querySelectorAll('.collapse').forEach((collapseParent) => {
      collapseParent.addEventListener('shown.bs.collapse', () => {
        localStorage.setItem(`collapse-${collapseParent.getAttribute('data-menu-id')}`, 'true');
      });

      collapseParent.addEventListener('hidden.bs.collapse', () => {
        localStorage.setItem(`collapse-${collapseParent.getAttribute('data-menu-id')}`, 'false');
      });
    })

  const currentPath = window.location.pathname;


  // Highlight the matching menu item
  document.querySelectorAll('.nav-item a').forEach(link => {
    if (link.getAttribute('href') === currentPath) {
      // Add 'active' class to the parent nav-item
      link.parentElement.classList.add('active');

      // Expand the menu if it's inside a collapsed menu
      let collapseParent = link.closest('.collapse');
      while (collapseParent) {
        collapseParent.classList.add('show');
        const toggleLink = collapseParent.previousElementSibling;
        if(toggleLink && toggleLink.classList.contains('collapsed')) toggleLink.classList.remove('collapsed');
        collapseParent = collapseParent.parentElement.closest('.collapsed');
      }
    }
  });
});

// document.addEventListener("DOMContentLoaded", function() {
//    const element = document.querySelector("#collapse-5");
//     if(element != null){
//         element.addEventListener("click", function(){
//           element.classList.toggle('show');
//           alert("clicked");
//         })
//         element.classList.toggle('show');
//     } else {
//         console.error("error or not found");
//     }      
// })
//USERLEVEL END
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-pQdfJHc2OehKxGwPUJ6CSvM4xP0z1pyXHdnzMUBwnSP5Hlw72Z5pApsTuW1X3s5i" crossorigin="anonymous"></script>
</body>
</html>